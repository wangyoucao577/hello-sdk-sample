name: Build 

on: push

jobs:

  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: Install Conan
      id: conan
      uses: turtlebrowser/get-conan@main
    - name: Conan version
      run: echo "${{ steps.conan.outputs.version }}"
    - name: Build
      run: conan create . demo/testing
    - name: Upload
      run: |
        conan remote add my-conan-repo https://wangyoucao577.jfrog.io/artifactory/api/conan/test-conan-local
        conan user -p ${{ secrets.MY_JFROG_IO_ACCESS_TOKEN }} -r my-conan-repo ${{ secrets.MY_JFROG_IO_USERNAME }}
        conan upload hello/0.1@demo/testing -r my-conan-repo --all
      